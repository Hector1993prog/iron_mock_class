# Exercise: Creating a Chatbot App with Gradio and ChatGPT

## Objective
In this exercise, you will create a chatbot application using Gradio that leverages a ChatGPT function. You’ll implement a simple user interface with Gradio, where users can input their questions and receive responses. This interface will also allow you to set system-level prompts and adjust various hyperparameters through configuration files managed by Hydra.

## Instructions

### 1. Chatbot App Overview
You will build a Gradio-based chatbot app using a pre-defined ChatGPT function. The ChatGPT function is already familiar to you from previous exercises, so here, the focus is on the integration with Gradio and managing configuration with Hydra.

### 2. Interface Requirements

Your Gradio interface should include the following components:

- **User Text Input Field**: This is where users can type in their messages to the chatbot.
- **System Prompt Input Field**: Here, you can set a system-level prompt to guide the chatbot's responses. This field allows for the dynamic adjustment of the chatbot’s behavior according to different contexts.
- **Response Output Field**: This is where the chatbot’s responses will be displayed after the user submits a question.

Additionally, ensure that the interface includes a **Submit Button** to trigger the ChatGPT function and generate a response.

### 3. Configuring Hyperparameters with Hydra

To control the behavior of the ChatGPT function, you will use several hyperparameters, such as:
   - `temperature`: Controls response randomness
   - `max_tokens`: Sets the maximum number of tokens in a response
   - `top_p`: Controls nucleus sampling for response diversity
   - `logprobs`: Determines whether token log probabilities are returned
   
These parameters should be managed through a YAML configuration file stored in a `config` directory. Use Hydra to read this configuration file and pass the values to the ChatGPT function when generating responses. Hydra allows you to keep hyperparameters flexible and easily modifiable by simply updating the YAML file.

### 4. File Structure Example

Here's a suggested file structure for your project:
```bash
chatbot_app/
├── config/
│   └── parameters.yaml    # YAML file with hyperparameters for ChatGPT
├── app.py                 # Main Gradio app script. Here the function will be housed. 
                           # Optionally you can create a end_point.py to write there the function.


```
### 5. Example of the YALM file
```yaml
key1: "value1"
key2: "value2"
```
You will have to figure it out using the [Hydra docs](https://hydra.cc/docs/intro/#basic-example) for that.

Also, you will ned to familirize with the simple [gradio apps](https://www.gradio.app/guides/quickstart)

### 6. Code Sample
Here you have the skeleton:
```python
@hydra.main(config_path="config", config_name="config")
def main(cfg: DictConfig):
    # Set OpenAI API key using Hydra configuration
    openai.api_key = cfg.OPENAI_API_KEY

    # Define a function to interact with ChatGPT, including a system role for behavior customization
    def get_chatgpt_response(prompt, system_instruction="You are a helpful assistant."):
        """
        This function sends a prompt to ChatGPT along with a system instruction 
        to control the chatbot's behavior.
        
        Parameters:
        - prompt (str): The user's input or question.
        - system_instruction (str): Instructions to define the chatbot's personality or role.

        Returns:
        - response content (str): The ChatGPT response.
        """
        #Fill up the response variable with the knowledge you have from the jupyter notebook.
        
        client = None #Your code here
       
        response = client.chat.completions.create(
            model=None,  # Specify the ChatGPT model
            messages=[
                None,  # System message to define behavior
                None                # User message (the prompt)
            ],
            # IMPORTANT: THESE PARAMETERS MUST BE CONTROLLED WITH THE YALM FILE!!!
            temperature=None
            max_completion_tokens=None,
            top_p=None,
            logprobs=None,
            top_logprobs=None,
        )
        # Return the content of the response generated by ChatGPT
        return None

    # Create a Gradio interface to interact with ChatGPT: 
    iface = #here your gradio app

    # Launch the Gradio app locally; a link to the app will be provided in the console
    iface.launch()

# Run the main function when the script is executed directly
if __name__ == "__main__":
    main()
```

Happy coding!!
